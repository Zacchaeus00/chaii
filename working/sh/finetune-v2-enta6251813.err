DeprecationWarning: 'source deactivate' is deprecated. Use 'conda deactivate'.
  0%|          | 0/167 [00:00<?, ?ba/s]  1%|          | 1/167 [00:25<1:11:51, 25.97s/ba]  1%|          | 2/167 [00:52<1:13:02, 26.56s/ba]  2%|▏         | 3/167 [01:22<1:15:45, 27.72s/ba]  2%|▏         | 4/167 [01:47<1:12:41, 26.76s/ba]  3%|▎         | 5/167 [02:14<1:12:29, 26.85s/ba]  4%|▎         | 6/167 [02:41<1:12:12, 26.91s/ba]  4%|▍         | 7/167 [03:07<1:11:08, 26.68s/ba]  5%|▍         | 8/167 [03:32<1:08:54, 26.00s/ba]  5%|▌         | 9/167 [04:00<1:10:25, 26.74s/ba]  6%|▌         | 10/167 [04:26<1:09:00, 26.37s/ba]  7%|▋         | 11/167 [04:50<1:07:03, 25.79s/ba]  7%|▋         | 12/167 [05:17<1:07:42, 26.21s/ba]  8%|▊         | 13/167 [05:45<1:08:27, 26.67s/ba]  8%|▊         | 14/167 [06:14<1:09:56, 27.43s/ba]  9%|▉         | 15/167 [06:40<1:08:40, 27.11s/ba] 10%|▉         | 16/167 [07:06<1:06:58, 26.61s/ba] 10%|█         | 17/167 [07:32<1:06:03, 26.42s/ba] 11%|█         | 18/167 [07:57<1:04:46, 26.08s/ba] 11%|█▏        | 19/167 [08:25<1:05:19, 26.49s/ba] 12%|█▏        | 20/167 [08:51<1:04:41, 26.41s/ba] 13%|█▎        | 21/167 [09:17<1:04:21, 26.45s/ba] 13%|█▎        | 22/167 [09:43<1:03:06, 26.12s/ba] 14%|█▍        | 23/167 [10:08<1:02:11, 25.91s/ba] 14%|█▍        | 24/167 [10:38<1:04:31, 27.07s/ba] 15%|█▍        | 25/167 [11:04<1:03:28, 26.82s/ba] 16%|█▌        | 26/167 [11:30<1:02:20, 26.53s/ba] 16%|█▌        | 27/167 [11:58<1:03:13, 27.10s/ba] 17%|█▋        | 28/167 [12:24<1:02:01, 26.78s/ba] 17%|█▋        | 29/167 [12:53<1:02:31, 27.19s/ba] 18%|█▊        | 30/167 [13:20<1:02:10, 27.23s/ba] 19%|█▊        | 31/167 [13:48<1:02:05, 27.39s/ba] 19%|█▉        | 32/167 [14:15<1:01:28, 27.32s/ba] 20%|█▉        | 33/167 [14:42<1:00:39, 27.16s/ba] 20%|██        | 34/167 [15:08<59:38, 26.91s/ba]   21%|██        | 35/167 [15:33<58:14, 26.47s/ba] 22%|██▏       | 36/167 [15:58<56:35, 25.92s/ba] 22%|██▏       | 37/167 [16:24<56:15, 25.96s/ba] 23%|██▎       | 38/167 [16:50<55:49, 25.96s/ba] 23%|██▎       | 39/167 [17:17<56:10, 26.33s/ba] 24%|██▍       | 40/167 [17:43<55:02, 26.01s/ba] 25%|██▍       | 41/167 [18:09<54:51, 26.13s/ba] 25%|██▌       | 42/167 [18:34<54:03, 25.95s/ba] 26%|██▌       | 43/167 [18:59<52:51, 25.58s/ba] 26%|██▋       | 44/167 [19:25<52:34, 25.65s/ba] 27%|██▋       | 45/167 [19:54<54:09, 26.63s/ba] 28%|██▊       | 46/167 [20:20<53:24, 26.49s/ba] 28%|██▊       | 47/167 [20:48<53:49, 26.91s/ba] 29%|██▊       | 48/167 [21:16<53:53, 27.17s/ba] 29%|██▉       | 49/167 [21:42<53:01, 26.96s/ba] 30%|██▉       | 50/167 [22:09<52:27, 26.90s/ba] 31%|███       | 51/167 [22:37<52:54, 27.37s/ba] 31%|███       | 52/167 [23:03<51:31, 26.88s/ba] 32%|███▏      | 53/167 [23:30<50:50, 26.76s/ba] 32%|███▏      | 54/167 [23:58<51:06, 27.14s/ba] 33%|███▎      | 55/167 [24:22<48:53, 26.19s/ba] 34%|███▎      | 56/167 [24:48<48:28, 26.20s/ba] 34%|███▍      | 57/167 [25:13<47:22, 25.84s/ba] 35%|███▍      | 58/167 [25:39<47:14, 26.00s/ba] 35%|███▌      | 59/167 [26:05<46:22, 25.77s/ba] 36%|███▌      | 60/167 [26:31<46:18, 25.97s/ba] 37%|███▋      | 61/167 [26:56<45:24, 25.71s/ba] 37%|███▋      | 62/167 [27:22<44:55, 25.68s/ba] 38%|███▊      | 63/167 [27:48<45:04, 26.00s/ba] 38%|███▊      | 64/167 [28:16<45:18, 26.40s/ba] 39%|███▉      | 65/167 [28:40<43:40, 25.69s/ba] 40%|███▉      | 66/167 [29:07<43:49, 26.03s/ba] 40%|████      | 67/167 [29:33<43:43, 26.24s/ba] 41%|████      | 68/167 [29:59<43:00, 26.06s/ba] 41%|████▏     | 69/167 [30:27<43:32, 26.66s/ba] 42%|████▏     | 70/167 [30:53<42:49, 26.49s/ba] 43%|████▎     | 71/167 [31:19<42:13, 26.39s/ba] 43%|████▎     | 72/167 [31:46<41:53, 26.45s/ba] 44%|████▎     | 73/167 [32:13<41:37, 26.57s/ba] 44%|████▍     | 74/167 [32:39<40:51, 26.36s/ba] 45%|████▍     | 75/167 [33:04<40:04, 26.13s/ba] 46%|████▌     | 76/167 [33:32<40:17, 26.56s/ba] 46%|████▌     | 77/167 [33:58<39:52, 26.59s/ba] 47%|████▋     | 78/167 [34:24<38:52, 26.21s/ba] 47%|████▋     | 79/167 [34:50<38:23, 26.18s/ba] 48%|████▊     | 80/167 [35:17<38:11, 26.34s/ba] 49%|████▊     | 81/167 [35:43<37:58, 26.49s/ba] 49%|████▉     | 82/167 [36:08<36:35, 25.83s/ba] 50%|████▉     | 83/167 [36:32<35:27, 25.33s/ba] 50%|█████     | 84/167 [36:56<34:42, 25.10s/ba] 51%|█████     | 85/167 [37:26<36:08, 26.45s/ba] 51%|█████▏    | 86/167 [37:53<36:06, 26.75s/ba] 52%|█████▏    | 87/167 [38:19<35:20, 26.50s/ba] 53%|█████▎    | 88/167 [38:47<35:17, 26.80s/ba] 53%|█████▎    | 89/167 [39:12<34:22, 26.45s/ba] 54%|█████▍    | 90/167 [39:38<33:38, 26.21s/ba] 54%|█████▍    | 91/167 [40:04<33:06, 26.13s/ba] 55%|█████▌    | 92/167 [40:29<32:22, 25.90s/ba] 56%|█████▌    | 93/167 [40:55<31:53, 25.86s/ba] 56%|█████▋    | 94/167 [41:20<30:57, 25.45s/ba] 57%|█████▋    | 95/167 [41:45<30:34, 25.48s/ba] 57%|█████▋    | 96/167 [42:11<30:15, 25.57s/ba] 58%|█████▊    | 97/167 [42:36<29:47, 25.53s/ba] 59%|█████▊    | 98/167 [43:01<29:08, 25.34s/ba] 59%|█████▉    | 99/167 [43:27<28:54, 25.50s/ba] 60%|█████▉    | 100/167 [43:55<29:12, 26.16s/ba] 60%|██████    | 101/167 [44:19<28:12, 25.64s/ba] 61%|██████    | 102/167 [44:48<28:52, 26.66s/ba] 62%|██████▏   | 103/167 [45:15<28:20, 26.56s/ba] 62%|██████▏   | 104/167 [45:41<27:47, 26.47s/ba] 63%|██████▎   | 105/167 [46:08<27:22, 26.50s/ba] 63%|██████▎   | 106/167 [46:33<26:30, 26.07s/ba] 64%|██████▍   | 107/167 [47:02<26:59, 27.00s/ba] 65%|██████▍   | 108/167 [47:27<25:53, 26.32s/ba] 65%|██████▌   | 109/167 [47:55<26:02, 26.93s/ba] 66%|██████▌   | 110/167 [48:19<24:47, 26.10s/ba] 66%|██████▋   | 111/167 [48:45<24:17, 26.03s/ba] 67%|██████▋   | 112/167 [49:11<23:49, 25.99s/ba] 68%|██████▊   | 113/167 [49:36<23:17, 25.88s/ba] 68%|██████▊   | 114/167 [50:02<22:53, 25.92s/ba] 69%|██████▉   | 115/167 [50:28<22:23, 25.85s/ba] 69%|██████▉   | 116/167 [50:54<22:02, 25.92s/ba] 70%|███████   | 117/167 [51:19<21:11, 25.43s/ba] 71%|███████   | 118/167 [51:43<20:36, 25.24s/ba] 71%|███████▏  | 119/167 [52:07<19:53, 24.86s/ba] 72%|███████▏  | 120/167 [52:35<20:03, 25.60s/ba] 72%|███████▏  | 121/167 [53:00<19:32, 25.49s/ba] 73%|███████▎  | 122/167 [53:26<19:19, 25.77s/ba] 74%|███████▎  | 123/167 [53:51<18:46, 25.60s/ba] 74%|███████▍  | 124/167 [54:18<18:29, 25.80s/ba] 75%|███████▍  | 125/167 [54:43<17:59, 25.70s/ba] 75%|███████▌  | 126/167 [55:09<17:29, 25.59s/ba] 76%|███████▌  | 127/167 [55:35<17:12, 25.82s/ba] 77%|███████▋  | 128/167 [56:00<16:43, 25.72s/ba] 77%|███████▋  | 129/167 [56:26<16:20, 25.80s/ba] 78%|███████▊  | 130/167 [56:50<15:30, 25.14s/ba] 78%|███████▊  | 131/167 [57:14<14:56, 24.89s/ba] 79%|███████▉  | 132/167 [57:42<15:05, 25.87s/ba] 80%|███████▉  | 133/167 [58:08<14:38, 25.83s/ba] 80%|████████  | 134/167 [58:34<14:12, 25.84s/ba] 81%|████████  | 135/167 [59:00<13:51, 25.97s/ba] 81%|████████▏ | 136/167 [59:26<13:23, 25.93s/ba] 82%|████████▏ | 137/167 [59:52<12:53, 25.77s/ba] 83%|████████▎ | 138/167 [1:00:18<12:36, 26.10s/ba] 83%|████████▎ | 139/167 [1:00:43<11:58, 25.67s/ba] 84%|████████▍ | 140/167 [1:01:10<11:41, 25.97s/ba] 84%|████████▍ | 141/167 [1:01:35<11:12, 25.88s/ba] 85%|████████▌ | 142/167 [1:02:02<10:51, 26.07s/ba] 86%|████████▌ | 143/167 [1:02:29<10:34, 26.43s/ba] 86%|████████▌ | 144/167 [1:02:57<10:14, 26.70s/ba] 87%|████████▋ | 145/167 [1:03:22<09:41, 26.42s/ba] 87%|████████▋ | 146/167 [1:03:49<09:17, 26.54s/ba] 88%|████████▊ | 147/167 [1:04:15<08:46, 26.34s/ba] 89%|████████▊ | 148/167 [1:04:40<08:11, 25.89s/ba] 89%|████████▉ | 149/167 [1:05:06<07:45, 25.84s/ba] 90%|████████▉ | 150/167 [1:05:32<07:22, 26.04s/ba] 90%|█████████ | 151/167 [1:05:57<06:50, 25.67s/ba] 91%|█████████ | 152/167 [1:06:22<06:20, 25.40s/ba] 92%|█████████▏| 153/167 [1:06:48<05:59, 25.67s/ba] 92%|█████████▏| 154/167 [1:07:13<05:32, 25.55s/ba] 93%|█████████▎| 155/167 [1:07:39<05:07, 25.59s/ba] 93%|█████████▎| 156/167 [1:08:04<04:39, 25.37s/ba] 94%|█████████▍| 157/167 [1:08:31<04:19, 25.97s/ba] 95%|█████████▍| 158/167 [1:08:55<03:47, 25.24s/ba] 95%|█████████▌| 159/167 [1:09:20<03:22, 25.32s/ba] 95%|█████████▌| 159/167 [1:09:41<03:30, 26.30s/ba]
Traceback (most recent call last):
  File "finetune-v2-enta.py", line 31, in <module>
    tokenized_train_ds = train_dataset.map(lambda x: prepare_train_features(x, tokenizer, args.max_length, args.doc_stride, tokenizer.padding_side == "right"), batched=True, remove_columns=train_dataset.column_names)
  File "/gpfsnyu/home/yw3642/.conda/envs/kaggle/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 1665, in map
    return self._map_single(
  File "/gpfsnyu/home/yw3642/.conda/envs/kaggle/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 185, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/gpfsnyu/home/yw3642/.conda/envs/kaggle/lib/python3.8/site-packages/datasets/fingerprint.py", line 397, in wrapper
    out = func(self, *args, **kwargs)
  File "/gpfsnyu/home/yw3642/.conda/envs/kaggle/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 2016, in _map_single
    batch = apply_function_on_filtered_inputs(
  File "/gpfsnyu/home/yw3642/.conda/envs/kaggle/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 1906, in apply_function_on_filtered_inputs
    function(*fn_args, effective_indices, **fn_kwargs) if with_indices else function(*fn_args, **fn_kwargs)
  File "finetune-v2-enta.py", line 31, in <lambda>
    tokenized_train_ds = train_dataset.map(lambda x: prepare_train_features(x, tokenizer, args.max_length, args.doc_stride, tokenizer.padding_side == "right"), batched=True, remove_columns=train_dataset.column_names)
  File "/gpfsnyu/scratch/yw3642/chaii/working/src/utils.py", line 92, in prepare_train_features
    tokenized_examples = tokenizer(
  File "/gpfsnyu/home/yw3642/.conda/envs/kaggle/lib/python3.8/site-packages/transformers/tokenization_utils_base.py", line 2395, in __call__
    return self.batch_encode_plus(
  File "/gpfsnyu/home/yw3642/.conda/envs/kaggle/lib/python3.8/site-packages/transformers/tokenization_utils_base.py", line 2580, in batch_encode_plus
    return self._batch_encode_plus(
  File "/gpfsnyu/home/yw3642/.conda/envs/kaggle/lib/python3.8/site-packages/transformers/tokenization_utils_fast.py", line 406, in _batch_encode_plus
    encodings = self._tokenizer.encode_batch(
Exception: Truncation error: Sequence to truncate too short to respect the provided max_length
